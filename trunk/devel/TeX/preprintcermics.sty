%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Jérôme LELONG                                                       %% 
%% CERMICS (ENPC)                                                      %%
%% http://cermics.enpc.fr/~lelong                                      %%
%% Ce paquet permet de rajouter une page de garde aux preprints        %%
%% du CERMICS.                                                         %%
%% Utilisation:                                                        %%
%% rajouter dans l'en-tête du.tex                                      %%
%%     \usepackage{preprint}                                           %%
%% puis avant la commande \maketitle                                   %%
%%      \pauthor[1]{premier auteur}                                    %%
%%      \paddress[1]{adresse premier auteur}                           %%
%%    et ainsi de suite pour les autres auteurs.                       %%
%% Si l'auteur  a la même adresse que l'auteur 1, alors on déclare     %%
%% d'abord les noms de auteurs ayant la même adresse et ensuite        %%
%% \pauthor[1]{second auteur}.                                         %%
%%                                                                     %%
%% Si un auteur a une adresse commune avec un autre et une             %%
%% adresse propre, alors on utilisera                                  %%
%% \pauthor[1,2]{auteur 3}                                             %%
%% \paddress[2]{adresse propre de l'auteur 3}                          %%
%%                                                                     %%
%% L'ordre d'apparition des commandes \pautthor et \paddress           %%
%% importe peu.                                                        %%
%%                                                                     %%
%% Déclarer le titre avec la commande                                  %%
%%     \ptitle{titre de l'article}                                     %%
%%                                                                     %%
%% Rien n'est imprimé avant que vous n'invoquiez                       %%
%%     \makeptitle (à mettre avant \maketitle)                         %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%     


\ProvidesPackage{preprintcermics}[21/12/2005 revision 1.1 by Jérôme LELONG]
\NeedsTeXFormat{LaTeX2e}



%% for details on atxy see
%% http://www-sop.inria.fr/apics/tralics/raweb.html
%%
\newbox\@atxybox%
\def\atxy(#1,#2)#3{\global\setbox\@atxybox=\hbox%
 {\unhbox\@atxybox
  \vtop to 0pt{\kern #2\hbox to 0pt{\kern #1\relax #3\hss}\vss}}}%

\def\@useatxy{%
  \vtop to 0pt{\kern-\headsep \kern-\topmargin \kern-\headheight
               \kern-1in \kern-\voffset
    \hbox to 0pt{\kern-\@themargin \kern-1in \kern-\hoffset
    \unhbox\@atxybox \hss}\vss}%
  \global\let\@texttop\relax}

\toks0={\setbox255=\vbox{\@useatxy \unvbox255}}
\output=\expandafter{\the\toks0\the\output}

\let\@cermicstitle\@empty
\let\@cermicsauthors\@empty
\let\@cermicsaddresses\@empty
\def\@cermicsdate{\number\day}


\newcommand{\cermicsmonthname}[1]{%
\ifcase#1
\or Janvier%
\or Février%
\or Mars%
\or Avril%
\or Mai%
\or Juin%
\or Juillet%
\or Août%
\or Septembre%
\or Octobre%
\or Novembre%
\or Décembre%
\fi}


\def\@cermicsdate{\cermicsmonthname{\month}\space\number\year}

%%font definitions
\def\cermicstitle@font
{\fontfamily{cmr}\fontencoding{T1}\fontseries{b}\fontshape{n}\fontsize{25}{30pt}\selectfont}

\def\cermicsauthor@font
{\fontfamily{cmr}\fontencoding{T1}\fontseries{m}\fontshape{n}\fontsize{14.4}{18pt}\selectfont}

\def\cermicsaddress@font
{\fontfamily{cmr}\fontencoding{T1}\fontseries{m}\fontshape{it}\fontsize{12}{13.6pt}\selectfont}

\def\cermicsnormal@font
{\fontfamily{cmr}\fontencoding{T1}\fontseries{m}\fontshape{n}\fontsize{12}{13.6pt}\selectfont}


\def\cermicsheader@font
{\fontfamily{cmr}\fontencoding{T1}\fontseries{m}\fontshape{n}\fontsize{10}{12pt}\selectfont}



%% to number author

\newcounter{total@cermicsauthors}
\setcounter{total@cermicsauthors}{0}
\newcounter{n@cermicsauthors}
\setcounter{n@cermicsauthors}{0}

\newcommand{\cermicsaddress}[2][]{
  \g@addto@macro\@cermicsaddresses{\cermicsaddress{#1}{#2}}}

\newcommand{\cermicsauthor}[2][]{
  \stepcounter{total@cermicsauthors}
  \g@addto@macro\@cermicsauthors{\cermicsauthor{#1}{#2}}}


  
\def\cermicstitle#1{
  \def\@cermicstitle{#1}}


\def\@setcermicsaddresses{%
  \begingroup%
  \def\cermicsaddress##1##2{%
    \vspace*{15pt}%
    \par\noindent {\cermicsaddress@font %
    \ifx\@empty##1 \else $^{##1}$\fi
    ##2}
  }%
  \@cermicsaddresses
  \endgroup
}

\def\@setcermicsauthors{%
  \begingroup%
  {\setlength{\baselineskip}{28pt}%
  \def\cermicsauthor##1##2{%
    \stepcounter{n@cermicsauthors}%
    \ifnum\then@cermicsauthors=\thetotal@cermicsauthors%
       \ifnum\thetotal@cermicsauthors>1%
         {\cermicsnormal@font \space\&~}\fi
    \else
      \ifnum\then@cermicsauthors>1%
        {\cermicsauthor@font,\space}\fi
    \fi
    {\cermicsauthor@font ##2%
      \ifx\@empty##1\else $^{##1}$\fi}%
  }%
  \@cermicsauthors
  \par}%
  \endgroup
}



\def\@setcermicstitle{
  {\cermicstitle@font
    \@cermicstitle
    \par
    \vspace*{50pt}}
}



\def\makecermicstitle{
  \@cermicsmaketitle
}

\def\@cermicsmaketitle{%
  {\cermicsnormal@font
  \thispagestyle{empty}
  \atxy(3cm,3cm){%
    \begin{minipage}[c][24.5cm][t]{15cm}
      {\cermicsheader@font
        \nobreak\noindent
        Rapport de recherche du CERMICS
        \hfill \@cermicsdate
        \newline
        \vspace{4pt}\noindent\rule{\linewidth}{1pt}
        \vspace{\stretch{1}}}%
      \begin{center}%
      \@setcermicstitle
      \ifx\@empty\cermicsauthors\else \@setcermicsauthors\fi
      \end{center}
      \vspace{\stretch{1}}
      \ifx\@empty\cermicsaddresses\else \@setcermicsaddresses\fi
      {\cermicsaddress@font
      \vspace{60pt}%
      \noindent
        \begin{center}
          CERMICS \textemdash\ ENPC\\%
          6 et 8 avenue Blaise Pascal\\%
          Cité Descartes - Champs sur Marne\\%
          77455 Marne la Vallée Cedex 2%
          \vspace*{10pt}
          \centerline{http://cermics.enpc.fr}
        \end{center}}
    \end{minipage}
  }%
  \null
  \newpage
  \thispagestyle{empty}
  \null
  \newpage
  \setcounter{page}{1}
  }
  \normalsize%  
} 

\endinput