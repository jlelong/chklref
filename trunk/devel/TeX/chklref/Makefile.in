#
# Jérôme Lelong <jerome.lelong@gmail.com>
# 
# January 2008.
#

INSTALL = @INSTALL@
PKGNAME = @PKGNAME@
TEXMFLOCAL = @TEXMFLOCAL@
prefix = @prefix@
bindir = ${prefix}/bin
datarootdir = ${prefix}/share/
binfiles = @binfiles@
distfiles = @distfiles@
sharefiles = @sharefiles@
texfiles = @texfiles@
texmf_prefix = $(prefix)/share/texmf
mandir = ${prefix}/share/doc/
latexdir=$(texmf_prefix)/tex/latex/$(PKGNAME)

VERSION=$(shell cat VERSION)

all::
	(cd man; make all)

install::
	(cd man; make install )
	mkdir -p ${bindir}
	$(INSTALL) -m 755 $(binfiles) $(bindir)
	mkdir -p ${datarootdir}/$(PKGNAME)
	$(INSTALL) -m 755 $(sharefiles) ${datarootdir}/$(PKGNAME)
	mkdir -p $(latexdir)
	$(INSTALL) -m 644 $(texfiles) $(latexdir)
	mkdir -p ${mandir}
	$(INSTALL) README $(mandir)/$(PKGNAME)/

uninstall::
	rm -f ${bindir}/chklref
	(cd man; make uninstall)


dist::
	rm -rf chklref-${VERSION}
	mkdir -p chklref-${VERSION}
	(cd chklref-${VERSION}; \
	cvs export -D 'today' TeX/chklref ;\
	mv TeX/chklref/* . ;\
	$(RM) -r TeX/chklref ;\
	$(RM) -r TeX )
	tar cf - chklref-${VERSION} | gzip > chklref-${VERSION}.tar.gz
	rm -rf chklref-${VERSION}

clean::
	$(RM) chklref 
	(cd man; make clean)
